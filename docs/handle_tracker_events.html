---

title: Chapter 2 - handle_tracker_events


keywords: fastai
sidebar: home_sidebar

summary: ": In this module, I analyse the common elements of all TrackerEvents and define some general-purpose functions that facilitate the processing of these events."
description: ": In this module, I analyse the common elements of all TrackerEvents and define some general-purpose functions that facilitate the processing of these events."
nb_path: "02_handle_tracker_events.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_handle_tracker_events.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rps_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./test_replays&quot;</span><span class="p">)</span>
<span class="n">game_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rps_path</span><span class="o">/</span><span class="s2">&quot;Jagannatha LE.SC2Replay&quot;</span><span class="p">)</span>
<span class="n">single_replay</span> <span class="o">=</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">load_replay</span><span class="p">(</span><span class="n">game_path</span><span class="p">)</span>
<span class="n">single_replay</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;sc2reader.resources.Replay at 0x1e3d4365f70&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Events">Events<a class="anchor-link" href="#Events"> </a></h2><p>In the previous module &lt;&lt;Chapter 1 - summarise_rpl&gt;&gt;, I discuss how <code>sc2reader</code> packs all information necessary to reproduce a match in a <code>Replay</code> object. I also showed how to obtain some descriptive information about the game from this object and the <code>Players</code> linked to it.</p>
<p>Here, I review the data contained in the <code>Replay</code>'s <code>Event</code> objects. These objects are crucial, given how</p>
<blockquote><p>:All of the gameplay and state information contained in the replay is packed into events. <a href="https://sc2reader.readthedocs.io/en/latest/events/index.html">(Kim, 2015, p. 22)</a>
The main types of events registered by sc2reader are:</p>
<ul>
<li>Game Events: Human actions and certain triggered events.</li>
<li>Message Events: Message and Pings to other players.</li>
<li>Tracker Events: Game state information.</li>
</ul>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Extract-events">Extract events<a class="anchor-link" href="#Extract-events"> </a></h3><p>The match's events can be extracted from the <code>Replay</code> or the <code>Participant</code> objects calling on their <code>events</code> attribute.</p>
<p>For example, I can extract a list of all the events in a replay as follows:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">match_events</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span><span class="p">]</span>

<span class="n">tracker_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">TrackerEvent</span><span class="p">)]</span>

<span class="n">game_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">GameEvent</span><span class="p">)]</span>

<span class="n">message_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">MessageEvent</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The match contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">match_events</span><span class="p">)</span><span class="si">}</span><span class="s1"> events total&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The match contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tracker_e</span><span class="p">)</span><span class="si">}</span><span class="s1"> events total&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The match contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">game_e</span><span class="p">)</span><span class="si">}</span><span class="s1"> events total&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The match contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">message_e</span><span class="p">)</span><span class="si">}</span><span class="s1"> events total&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The match contains 4988 events total
The match contains 830 events total
The match contains 4143 events total
The match contains 15 events total
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the following test, I check that the sum of the Tracker, Message and Game events effectively make up the whole of the events registered by the system.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ft</span><span class="o">.</span><span class="n">equals</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">tracker_e</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">game_e</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">message_e</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">match_events</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tracker-Events">Tracker Events<a class="anchor-link" href="#Tracker-Events"> </a></h2><p>These events store information relative to the state of the game. Additionally, one can use them to track various aspects of a player's performance.</p>
<p>Here, I review the types of <code>TrackerEvents</code> and the data one can extract from them that I found helpful in later modules.
{% include note.html content='each type of object stores other data that goes beyond the data points I explore here. To extract a complete list of the data stored in each type of event, you can call the <code>__dict__</code> attribute on an object of each type.' %}
Here, I also create various helper functions that address some management issues common to these events. For example, I include the <a href="/sc_training/handle_tracker_events.html#calc_realtime_index"><code>calc_realtime_index</code></a> function, which corrects an event's time index to match the duration of a match.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Types-of-Tracker-Events">Types of Tracker Events<a class="anchor-link" href="#Types-of-Tracker-Events"> </a></h3><p>This section reviews different types of <code>TrackerEvents</code>, their attributes, and some of the issues I need to consider regarding each class.
{% include note.html content='The official <code>TrackerEvents</code> documentation can be found at <a href="https://sc2reader.readthedocs.io/en/latest/events/tracker.html">(Kim, 2015, p. 24-25)</a>.' %}
In a replay, one will typically found all kinds of <code>TrackerEvents</code>. To illustrate this, in the following code, I build a <code>set</code> containing the types of a sample replay's <code>TrackerEvents</code>. The resulting set lists all the <code>TrackerEvent</code>'s classes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tracker_e_types</span> <span class="o">=</span> <span class="p">{</span><span class="nb">type</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
             <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">TrackerEvent</span><span class="p">)}</span>

<span class="n">tracker_e_types</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{sc2reader.events.tracker.PlayerSetupEvent,
 sc2reader.events.tracker.PlayerStatsEvent,
 sc2reader.events.tracker.UnitBornEvent,
 sc2reader.events.tracker.UnitDiedEvent,
 sc2reader.events.tracker.UnitDoneEvent,
 sc2reader.events.tracker.UnitInitEvent,
 sc2reader.events.tracker.UnitPositionsEvent,
 sc2reader.events.tracker.UnitTypeChangeEvent,
 sc2reader.events.tracker.UpgradeCompleteEvent}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="PlayerSetupEvent">PlayerSetupEvent<a class="anchor-link" href="#PlayerSetupEvent"> </a></h3><p>These are basic events used by the system to organise players at the start of the match. However, since most of the data they stored exists elsewhere, I will not use this type of events.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">setup_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
           <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">PlayerSetupEvent</span><span class="p">)</span> 
           <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="PlayerStatsEvents">PlayerStatsEvents<a class="anchor-link" href="#PlayerStatsEvents"> </a></h3><p>To extract some initial information regarding the game's flow, one can consult the instances of <code>sc2reader.events.tracker.PlayerStatsEvent</code>.</p>
<p>These events are generated for each player every ten seconds, regardless of the player's presence in the match. In other words, if one is analysing a game of more than two players and one is defeated, the game still generates <code>PlayerStatsEvents</code> for that player up until the end of the match.</p>
<p>Additionally, the game generates a <code>PlayerStatEvent</code> when a player leaves (i.e. defeated or surrenders) and when the match ends.
{% include warning.html content='In 1v1 games, the above behaviour can cause the losing player to have two events generated at the end of the game. One for leaving and one for the end of the game. Source <a href="https://sc2reader.readthedocs.io/en/latest/events/tracker.html">(Kim, 2015, p. 24)</a>' %}
Following these rules, one can estimate the number of <code>PlayerStatsEvents</code> a match should have. For example, the following sample match lasted 590 seconds. Hence, there should be 59 <code>PlayerStatEvent</code>s per player, plus two or three for start and end events. Similarly, taking into account the game's frames-per-second, one could estimate the duration of the match in frames.</p>
<p>Bellow, I show how one can get this information from a <code>Replay</code> object. This information is critical for debugging and managing these events afterwards.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rpl_length</span> <span class="o">=</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">game_length</span><span class="o">.</span><span class="n">seconds</span>
<span class="n">rpl_fps</span> <span class="o">=</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">game_fps</span>
<span class="n">rpl_frame_length</span> <span class="o">=</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">game_length</span><span class="o">.</span><span class="n">seconds</span> <span class="o">*</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">game_fps</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;Game length in seconds:&quot;</span><span class="si">:</span><span class="s1">&lt;30</span><span class="si">}{</span><span class="n">rpl_length</span><span class="si">:</span><span class="s1">&gt;6</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;Game frames per second:&quot;</span><span class="si">:</span><span class="s1">&lt;30</span><span class="si">}{</span><span class="n">rpl_fps</span><span class="si">:</span><span class="s1">&gt;6</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;Total frames in the match:&quot;</span><span class="si">:</span><span class="s1">&lt;30</span><span class="si">}{</span><span class="n">rpl_frame_length</span><span class="si">:</span><span class="s1">&gt;6</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Game length in seconds:          590
Game frames per second:         16.0
Total frames in the match:    9440.0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Likewise, in the following code, I extract the <code>PlayerStatEvent</code> related to one player in the test match I am analysing.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_one_state</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">match_events</span> 
               <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">PlayerStatsEvent</span><span class="p">)</span> 
               <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of PlayerStatsEvents for player 1: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">p_one_state</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of PlayerStatsEvents for player 1: 85
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This information shows that there is a discrepancy in the number of <code>PlayerStatsEvenst</code> there should be (around 60 for the sample match) and the actual number there is (85).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similarly, looking at the seconds and frame count registered in the last event, it is clear that they do not match the duration of the game (590 seconds, 9440 frames).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Second recorded in the last event: </span><span class="si">{</span><span class="n">p_one_state</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">p_one_state</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frame recorded in the last event: </span><span class="si">{</span><span class="n">p_one_state</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">p_one_state</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">frame</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Second recorded in the last event: 826
Frame recorded in the last event: 13224
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fortunately, these mismatches are consistent for all the players. For example, look at the number of events, the last second and frame registered for Player 2. This player has one event less because they were the match's winner.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_two_state</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">match_events</span> 
               <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">PlayerStatsEvent</span><span class="p">)</span> 
               <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of events recorded for p2: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">p_two_state</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Second recorded in the last event: </span><span class="si">{</span><span class="n">p_two_state</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">p_two_state</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frame recorded in the last event: </span><span class="si">{</span><span class="n">p_two_state</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">p_two_state</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">frame</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of events recorded for p2: 84
Second recorded in the last event: 826
Frame recorded in the last event: 13224
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='because this time index discrepancy also affects other types of <code>Events</code>. I propose a basic solution in the functions section of this module further below (see <a href="/sc_training/handle_tracker_events.html#calc_realtime_index"><code>calc_realtime_index</code></a> function).' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Unit-trackers">Unit trackers<a class="anchor-link" href="#Unit-trackers"> </a></h3><p>The following events contain data regarding the different units in the game. These units include player-controlled units and others, as well as structures and troops. However, in this case, I am primarily interested in the buildings and troops controlled by players.</p>
<h4 id="UnitBornEvent">UnitBornEvent<a class="anchor-link" href="#UnitBornEvent"> </a></h4><p>This type of event stores the following useful attributes:</p>
<ul>
<li><code>second</code> (int): registered time of birth in seconds. Note that this timestamp does not match the match's duration. This inconsistency means that one must correct the time index of the event. (see <a href="/sc_training/handle_tracker_events.html#calc_realtime_index"><code>calc_realtime_index</code></a> function)</li>
<li><code>unit_type_name</code> (str): type of the unit.</li>
<li><code>location</code> (tuple(x, y)): tuple of ints that indicate the unit's x and y coordinates in the map.</li>
<li><code>control_pid</code> (int): player id in the match.</li>
<li><code>unit</code>: points to the <code>unit</code> object, which stores helpful information such as the minerals, vespene, and supply cost of the unit type <a href="https://sc2reader.readthedocs.io/en/latest/dataobjects.html?highlight=unit#sc2reader.data.Unit">(see Kim, 2015, p. 30)</a>.</li>
</ul>
<p>The following code illustrates some uses of these attributes:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># of a single player.</span>
<span class="n">UnitBorn_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">match_events</span> 
              <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UnitBornEvent</span><span class="p">)</span> 
              <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">control_pid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> 

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;The recorded time of birth of a unit:&quot;</span><span class="si">:</span><span class="s1">&lt;40</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">UnitBorn_e</span><span class="p">[</span><span class="mi">62</span><span class="p">]</span><span class="o">.</span><span class="n">second</span><span class="si">:</span><span class="s1">&gt;10</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;The supply cost of the unit type:&quot;</span><span class="si">:</span><span class="s1">&lt;40</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">UnitBorn_e</span><span class="p">[</span><span class="mi">62</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">supply</span><span class="si">:</span><span class="s1">&gt;10</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;The unit type:&quot;</span><span class="si">:</span><span class="s1">&lt;40</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">UnitBorn_e</span><span class="p">[</span><span class="mi">62</span><span class="p">]</span><span class="o">.</span><span class="n">unit_type_name</span><span class="si">:</span><span class="s1">&gt;10</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;The birth x, y location of the unit:&quot;</span><span class="si">:</span><span class="s1">&lt;40</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">UnitBorn_e</span><span class="p">[</span><span class="mi">62</span><span class="p">]</span><span class="o">.</span><span class="n">location</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;10</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The recorded time of birth of a unit:           731
The supply cost of the unit type:                 4
The unit type:                             Immortal
The birth x, y location of the unit:       (72, 40)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To group all the game's <code>UnitBornEvents</code>, I can use the  <code>control_pid</code> attribute, which points to the <code>Participant</code> that owns the unit.
{% include tip.html content='Units with <code>control_pid</code> equal 0 are neutral units such as minerals, vespene geysers or obstacles.' %}
With this grouping, I can start to compose that player's build order. That is their sequence of built units during the game (see &lt;&lt;Chapter 4 - build_parser&gt;&gt;).</p>
<p>Additionally, having grouped all the <code>UnitBornEvent</code> instances related to a particular player, I notice the following pattern:</p>
<ul>
<li>The first 15 units born (indexes 0-14) are <code>Beacons</code> sc2reader uses for tracking. I will ignore these objects.</li>
<li>Unit 15 is the starting base building (Nexus, CommandCenter, Hatchery).</li>
<li>Units 16-27 are the first worker units of each player.</li>
</ul>
<p>This pattern means I should only consider whatever units are born after index 27 to track the player's build order.</p>
<p>The following code illustrates this pattern.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">UnitBorn_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">match_events</span>
              <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UnitBornEvent</span><span class="p">)</span> 
              <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">control_pid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">born_order</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:(</span><span class="n">k</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">unit_type_name</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;second: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
             <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">UnitBorn_e</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;=</span><span class="mi">30</span><span class="p">}</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">born_order</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{0: (0, &#39;BeaconArmy&#39;, &#39;second: 0&#39;),
 1: (1, &#39;BeaconDefend&#39;, &#39;second: 0&#39;),
 2: (2, &#39;BeaconAttack&#39;, &#39;second: 0&#39;),
 3: (3, &#39;BeaconHarass&#39;, &#39;second: 0&#39;),
 4: (4, &#39;BeaconIdle&#39;, &#39;second: 0&#39;),
 5: (5, &#39;BeaconAuto&#39;, &#39;second: 0&#39;),
 6: (6, &#39;BeaconDetect&#39;, &#39;second: 0&#39;),
 7: (7, &#39;BeaconScout&#39;, &#39;second: 0&#39;),
 8: (8, &#39;BeaconClaim&#39;, &#39;second: 0&#39;),
 9: (9, &#39;BeaconExpand&#39;, &#39;second: 0&#39;),
 10: (10, &#39;BeaconRally&#39;, &#39;second: 0&#39;),
 11: (11, &#39;BeaconCustom1&#39;, &#39;second: 0&#39;),
 12: (12, &#39;BeaconCustom2&#39;, &#39;second: 0&#39;),
 13: (13, &#39;BeaconCustom3&#39;, &#39;second: 0&#39;),
 14: (14, &#39;BeaconCustom4&#39;, &#39;second: 0&#39;),
 15: (15, &#39;Nexus&#39;, &#39;second: 0&#39;),
 16: (16, &#39;Probe&#39;, &#39;second: 0&#39;),
 17: (17, &#39;Probe&#39;, &#39;second: 0&#39;),
 18: (18, &#39;Probe&#39;, &#39;second: 0&#39;),
 19: (19, &#39;Probe&#39;, &#39;second: 0&#39;),
 20: (20, &#39;Probe&#39;, &#39;second: 0&#39;),
 21: (21, &#39;Probe&#39;, &#39;second: 0&#39;),
 22: (22, &#39;Probe&#39;, &#39;second: 0&#39;),
 23: (23, &#39;Probe&#39;, &#39;second: 0&#39;),
 24: (24, &#39;Probe&#39;, &#39;second: 0&#39;),
 25: (25, &#39;Probe&#39;, &#39;second: 0&#39;),
 26: (26, &#39;Probe&#39;, &#39;second: 0&#39;),
 27: (27, &#39;Probe&#39;, &#39;second: 0&#39;),
 28: (28, &#39;Probe&#39;, &#39;second: 18&#39;),
 29: (29, &#39;Probe&#39;, &#39;second: 69&#39;),
 30: (30, &#39;Probe&#39;, &#39;second: 133&#39;)}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='the first unit borned past second 0 is the 28th unit boned at 18th second.' %}
This information can also serve as the basis for a unit count (see &lt;&lt;Chapter 4 - build_parser&gt;&gt;).</p>
<p>For example, the following code produces a draft of the player's final unit tally.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">UnitBorn_e</span><span class="p">:</span>
    <span class="n">counts</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">unit_type_name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">counts</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">unit_type_name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="n">counts</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;BeaconArmy&#39;: 1,
 &#39;BeaconDefend&#39;: 1,
 &#39;BeaconAttack&#39;: 1,
 &#39;BeaconHarass&#39;: 1,
 &#39;BeaconIdle&#39;: 1,
 &#39;BeaconAuto&#39;: 1,
 &#39;BeaconDetect&#39;: 1,
 &#39;BeaconScout&#39;: 1,
 &#39;BeaconClaim&#39;: 1,
 &#39;BeaconExpand&#39;: 1,
 &#39;BeaconRally&#39;: 1,
 &#39;BeaconCustom1&#39;: 1,
 &#39;BeaconCustom2&#39;: 1,
 &#39;BeaconCustom3&#39;: 1,
 &#39;BeaconCustom4&#39;: 1,
 &#39;Nexus&#39;: 1,
 &#39;Probe&#39;: 45,
 &#39;Stalker&#39;: 3,
 &#39;Sentry&#39;: 1,
 &#39;Immortal&#39;: 4}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="UnitInitEvent">UnitInitEvent<a class="anchor-link" href="#UnitInitEvent"> </a></h4><p>This type of event is a complement to the <code>UnitBonrEvent</code>, <code>UnitDoneEvent</code> and the <code>UnitTypeChangeEvent</code>.</p>
<p>These events exists because not all units are born into the game. Instead, buildings (other than the initial base), warped units, mutated units, and others are instantiated through the <code>UnitInitEvent</code> with 0 life. Afterwards, they are built over time. During this building time, players may lose or cancel this unit or buildings under construction.</p>
<p>The information extracted from these type of events is similar to the information in the <code>UnitBornedEvent</code>. Here, again, I will use the following attributes:</p>
<ul>
<li><code>second</code> (int): registered time of birth in seconds. This attribute requires the same consideration as in the previous cases. (see <a href="/sc_training/handle_tracker_events.html#calc_realtime_index"><code>calc_realtime_index</code></a> function)</li>
<li><code>unit_type_name</code> (str): type of the unit.</li>
<li><code>location</code> (tuple(x, y)): tuple of ints that indicate the unit's x and y coordinates in the map.</li>
<li><code>control_pid</code> (int): player id in the match.</li>
<li><code>unit</code>: points to the <code>unit</code> object, which stores helpful information such as the minerals, vespene, and supply cost of the unit type <a href="https://sc2reader.readthedocs.io/en/latest/dataobjects.html?highlight=unit#sc2reader.data.Unit">(see Kim, 2015, p. 30)</a>.
{% include note.html content='in this case, there are no initial units that should be disregarded from the player&#8217;s build order.' %}</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">UnitInit_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">match_events</span> 
              <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UnitInitEvent</span><span class="p">)</span> 
              <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">control_pid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">init_order</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:(</span><span class="n">event</span><span class="o">.</span><span class="n">unit_type_name</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;second: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
             <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">UnitInit_e</span><span class="p">)}</span>

<span class="n">init_order</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{0: (&#39;Pylon&#39;, &#39;second: 47&#39;),
 1: (&#39;Pylon&#39;, &#39;second: 74&#39;),
 2: (&#39;Gateway&#39;, &#39;second: 91&#39;),
 3: (&#39;Gateway&#39;, &#39;second: 100&#39;),
 4: (&#39;Forge&#39;, &#39;second: 111&#39;),
 5: (&#39;CyberneticsCore&#39;, &#39;second: 170&#39;),
 6: (&#39;Assimilator&#39;, &#39;second: 182&#39;),
 7: (&#39;Assimilator&#39;, &#39;second: 188&#39;),
 8: (&#39;Pylon&#39;, &#39;second: 203&#39;),
 9: (&#39;Pylon&#39;, &#39;second: 224&#39;),
 10: (&#39;PhotonCannon&#39;, &#39;second: 241&#39;),
 11: (&#39;PhotonCannon&#39;, &#39;second: 244&#39;),
 12: (&#39;PhotonCannon&#39;, &#39;second: 260&#39;),
 13: (&#39;PhotonCannon&#39;, &#39;second: 264&#39;),
 14: (&#39;Pylon&#39;, &#39;second: 316&#39;),
 15: (&#39;Nexus&#39;, &#39;second: 322&#39;),
 16: (&#39;RoboticsFacility&#39;, &#39;second: 368&#39;),
 17: (&#39;Assimilator&#39;, &#39;second: 381&#39;),
 18: (&#39;Assimilator&#39;, &#39;second: 385&#39;),
 19: (&#39;RoboticsFacility&#39;, &#39;second: 408&#39;),
 20: (&#39;RoboticsFacility&#39;, &#39;second: 411&#39;),
 21: (&#39;Zealot&#39;, &#39;second: 479&#39;),
 22: (&#39;Zealot&#39;, &#39;second: 487&#39;),
 23: (&#39;Sentry&#39;, &#39;second: 540&#39;),
 24: (&#39;Pylon&#39;, &#39;second: 651&#39;),
 25: (&#39;Pylon&#39;, &#39;second: 662&#39;),
 26: (&#39;Nexus&#39;, &#39;second: 682&#39;),
 27: (&#39;PhotonCannon&#39;, &#39;second: 693&#39;),
 28: (&#39;PhotonCannon&#39;, &#39;second: 702&#39;),
 29: (&#39;Zealot&#39;, &#39;second: 705&#39;),
 30: (&#39;Zealot&#39;, &#39;second: 706&#39;),
 31: (&#39;Stalker&#39;, &#39;second: 755&#39;),
 32: (&#39;Stalker&#39;, &#39;second: 755&#39;),
 33: (&#39;Stalker&#39;, &#39;second: 803&#39;),
 34: (&#39;Stalker&#39;, &#39;second: 804&#39;)}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Also, given that these units can be buildings, troops or others, we can use this list to illustrate the use of the <code>unit.is_army</code>, <code>unit.is_building</code>, <code>unit.is_worker</code> attributes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit_name: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> is building: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">is_building</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit_name: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> is army: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">is_army</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit_name: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> is worker: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">is_worker</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Unit_name: RoboticsFacility is building: True
Unit_name: RoboticsFacility is army: False
Unit_name: RoboticsFacility is worker: False
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit_name: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> is building: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">is_building</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit_name: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> is army: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">is_army</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit_name: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> is worker: </span><span class="si">{</span><span class="n">UnitInit_e</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">is_worker</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Unit_name: Stalker is building: False
Unit_name: Stalker is army: True
Unit_name: Stalker is worker: False
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="UnitDoneEvent">UnitDoneEvent<a class="anchor-link" href="#UnitDoneEvent"> </a></h4><p>This type of event is a complement to the <code>UnitBonrEvent</code> and <code>UnitInitEvent</code>.</p>
<p>After a <code>UnitInitEvent</code> and the unit's build time the unit comes into the game. At this point the unit triggers a <code>UnitDoneEvent</code>.</p>
<p>This type of event has much less attributes associated to it than the <code>UnitBonrEvent</code> and <code>UnitInitEvent</code>. In this case, I will use the <code>second</code> and <code>unit</code> attributes.</p>
<p>If I want to use these events to construct the build order based on completed units and not just only in units that where initiated, I need to use some of the <code>unit</code> object's attributes to complete the information. For example, to group the units per player I can use the <code>unit.owner.pid</code> attribute.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">UnitDone_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">match_events</span> 
              <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UnitDoneEvent</span><span class="p">)</span>
             <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following code illustrates how an event's unit can offer some complementary attributes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample_unit</span> <span class="o">=</span> <span class="n">UnitDone_e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Event</span><span class="se">\&#39;</span><span class="s1">s execution time: </span><span class="si">{</span><span class="n">UnitDone_e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Event</span><span class="se">\&#39;</span><span class="s1">s execution frame: </span><span class="si">{</span><span class="n">UnitDone_e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">frame</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample_unit</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Init frame: </span><span class="si">{</span><span class="n">sample_unit</span><span class="o">.</span><span class="n">started_at</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Game-enter frame: </span><span class="si">{</span><span class="n">sample_unit</span><span class="o">.</span><span class="n">finished_at</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Owner: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">sample_unit</span><span class="o">.</span><span class="n">owner</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Event&#39;s execution time: 124
Event&#39;s execution frame: 1999
Refinery
Init frame: 1519
Game-enter frame: 1999
Owner: Player 2 - MxChrisxM (Terran)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="UpgradeCompleteEvent">UpgradeCompleteEvent<a class="anchor-link" href="#UpgradeCompleteEvent"> </a></h4><p>Other than constructing buildings and training troops, the third way players can spend their resources is by researching upgrades. Each time a player completes an upgrade it generates a <code>UpgradeCompleteEvent</code>.</p>
<p>I will use the following features from this event type:</p>
<ul>
<li><code>pid</code> (int): player id in the match.</li>
<li><code>upgrade_type_name</code> (str): name of the upgrade.</li>
<li><code>second (int)</code>: registered time of birth in seconds. This attribute requires the same consideration as in the previous cases. (see <a href="/sc_training/handle_tracker_events.html#calc_realtime_index"><code>calc_realtime_index</code></a> function)</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Upgrades</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
           <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UpgradeCompleteEvent</span><span class="p">)</span> 
           <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">upgrade_order</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:(</span><span class="sa">f</span><span class="s1">&#39;second: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">upgrade_type_name</span><span class="p">)</span> 
                 <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Upgrades</span><span class="p">)}</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">upgrade_order</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{0: (&#39;second: 0&#39;, &#39;RewardDanceGhost&#39;),
 1: (&#39;second: 0&#39;, &#39;RewardDanceMule&#39;),
 2: (&#39;second: 0&#39;, &#39;RewardDanceViking&#39;),
 3: (&#39;second: 0&#39;, &#39;SprayTerran&#39;),
 4: (&#39;second: 0&#39;, &#39;SprayTerran&#39;),
 5: (&#39;second: 165&#39;, &#39;SprayTerran&#39;),
 6: (&#39;second: 265&#39;, &#39;SprayTerran&#39;),
 7: (&#39;second: 550&#39;, &#39;SprayTerran&#39;),
 8: (&#39;second: 613&#39;, &#39;TerranVehicleWeaponsLevel1&#39;),
 9: (&#39;second: 650&#39;, &#39;SprayTerran&#39;),
 10: (&#39;second: 664&#39;, &#39;SmartServos&#39;),
 11: (&#39;second: 712&#39;, &#39;HighCapacityBarrels&#39;),
 12: (&#39;second: 819&#39;, &#39;SprayTerran&#39;)}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='The upgrades that start with names that start with Spray or Reward should not be counted as activated by the player. They are generated by the game as a reward for a player&#8217;s achievements but do not affect gameplay.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="UnitTypeChangeEvent">UnitTypeChangeEvent<a class="anchor-link" href="#UnitTypeChangeEvent"> </a></h4><p>During a game some units and buildings appear (they change type) as the product of tech research, player ordered morphs, mergings and upgrades.</p>
<p>Meanwhile, some objects can change states through the match, while they remain the same unti type. For example, zerg units can burrow, some terran and protoss units cloack, and units such as siege tanks can change between several modes, like siege and tank mode.</p>
<p>All these changes are registered by the <code>UnitTypeChangeEvent</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prototype</span> <span class="o">=</span> <span class="p">{(</span><span class="n">event</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">unit_type_name</span><span class="p">):</span> 
            <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">is_army</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">unit_id</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UnitTypeChangeEvent</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="n">sort_dicts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{(473, &#39;WarpGate&#39;): (False, 58195969), (480, &#39;WarpGate&#39;): (False, 57671681)}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prototype_2</span> <span class="o">=</span> <span class="p">{(</span><span class="n">event</span><span class="o">.</span><span class="n">second</span><span class="p">,</span><span class="n">event</span><span class="o">.</span><span class="n">unit_type_name</span><span class="p">):</span> 
              <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">is_army</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">unit_id</span><span class="p">)</span> 
              <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
              <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UnitTypeChangeEvent</span><span class="p">)</span>
              <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">}</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">prototype_2</span><span class="p">,</span> <span class="n">sort_dicts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{(159, &#39;SupplyDepotLowered&#39;): (False, 59244545),
 (163, &#39;OrbitalCommand&#39;): (False, 51380225),
 (257, &#39;FactoryFlying&#39;): (False, 62390273),
 (260, &#39;BarracksFlying&#39;): (False, 56360961),
 (260, &#39;TechLab&#39;): (False, 59768833),
 (270, &#39;CommandCenterFlying&#39;): (False, 60555265),
 (273, &#39;Factory&#39;): (False, 62390273),
 (273, &#39;FactoryTechLab&#39;): (False, 59768833),
 (299, &#39;CommandCenter&#39;): (False, 60555265),
 (302, &#39;Barracks&#39;): (False, 56360961),
 (327, &#39;SiegeTankSieged&#39;): (True, 67633153),
 (334, &#39;OrbitalCommand&#39;): (False, 60555265),
 (348, &#39;SiegeTank&#39;): (True, 67633153),
 (357, &#39;SiegeTankSieged&#39;): (True, 67633153),
 (377, &#39;SiegeTank&#39;): (True, 67633153),
 (385, &#39;SiegeTankSieged&#39;): (True, 67633153),
 (389, &#39;OrbitalCommandFlying&#39;): (False, 60555265),
 (398, &#39;SiegeTankSieged&#39;): (True, 71565313),
 (419, &#39;OrbitalCommand&#39;): (False, 60555265),
 (471, &#39;FactoryFlying&#39;): (False, 72089601),
 (472, &#39;BarracksFlying&#39;): (False, 56360961),
 (472, &#39;Reactor&#39;): (False, 69206017),
 (481, &#39;Factory&#39;): (False, 72089601),
 (481, &#39;FactoryReactor&#39;): (False, 69206017),
 (486, &#39;Barracks&#39;): (False, 56360961),
 (506, &#39;SupplyDepotLowered&#39;): (False, 76021761),
 (508, &#39;SupplyDepotLowered&#39;): (False, 76808193),
 (516, &#39;BarracksFlying&#39;): (False, 56360961),
 (516, &#39;TechLab&#39;): (False, 77856769),
 (536, &#39;Barracks&#39;): (False, 56360961),
 (556, &#39;SupplyDepotLowered&#39;): (False, 78643201),
 (575, &#39;SiegeTankSieged&#39;): (True, 82575361),
 (580, &#39;FactoryTechLab&#39;): (False, 77856769),
 (643, &#39;HellionTank&#39;): (True, 89653249),
 (648, &#39;SiegeTank&#39;): (True, 82575361),
 (648, &#39;ThorAP&#39;): (False, 87818241),
 (691, &#39;OrbitalCommand&#39;): (False, 83361793),
 (715, &#39;SiegeTankSieged&#39;): (True, 82575361),
 (749, &#39;SupplyDepotLowered&#39;): (False, 72613892),
 (761, &#39;SiegeTank&#39;): (True, 71565313),
 (768, &#39;SiegeTankSieged&#39;): (True, 71565313),
 (770, &#39;SiegeTankSieged&#39;): (True, 82575361),
 (782, &#39;HellionTank&#39;): (True, 91226113),
 (824, &#39;SiegeTank&#39;): (True, 82575361)}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="UnitDiedEvent">UnitDiedEvent<a class="anchor-link" href="#UnitDiedEvent"> </a></h4><p>These events are generated when units are taken off the match for any reason.</p>
<p>Since <code>UnitDiedEvents</code> can be triggered when a unit is morphed, merged or exhausted, it is important not to assume that every kill results from an opponent's actions.</p>
<p>Thus, in this case, I will use the following attributes:</p>
<ul>
<li><code>second</code> (int): registered time of birth in seconds. This attribute requires the same consideration as in the previous cases. (see <a href="/sc_training/handle_tracker_events.html#calc_realtime_index"><code>calc_realtime_index</code></a> function)</li>
<li><code>killer_pid</code> (int): player id for the player who destroys a unit. This attribute can be a significant component to build a player kill list.</li>
<li><code>unit</code> (unit)</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">UnitDied_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
              <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UnitDiedEvent</span><span class="p">)</span>
             <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">killer_pid</span> <span class="o">==</span> <span class="mi">1</span> 
             <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">owner</span> <span class="o">!=</span> <span class="kc">None</span>
             <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">kill_list</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:(</span><span class="sa">f</span><span class="s1">&#39;second: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">second</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;unit: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s1">&lt;16</span><span class="si">}</span><span class="s1">, owner: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s1">, killer:</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">killer_pid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">UnitDied_e</span><span class="p">)}</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Player 1 kill list:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">kill_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Player 1 kill list:
{0: (&#39;second: 304&#39;, &#39;unit: SCV             , owner: 2, killer:1&#39;),
 1: (&#39;second: 608&#39;, &#39;unit: Hellion         , owner: 2, killer:1&#39;),
 2: (&#39;second: 617&#39;, &#39;unit: Hellion         , owner: 2, killer:1&#39;),
 3: (&#39;second: 687&#39;, &#39;unit: BattleHellion   , owner: 2, killer:1&#39;),
 4: (&#39;second: 703&#39;, &#39;unit: BattleHellion   , owner: 2, killer:1&#39;),
 5: (&#39;second: 723&#39;, &#39;unit: SiegeTankSieged , owner: 2, killer:1&#39;),
 6: (&#39;second: 769&#39;, &#39;unit: BattleHellion   , owner: 2, killer:1&#39;),
 7: (&#39;second: 781&#39;, &#39;unit: Hellion         , owner: 2, killer:1&#39;),
 8: (&#39;second: 790&#39;, &#39;unit: BattleHellion   , owner: 2, killer:1&#39;)}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">UnitPos_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> 
            <span class="ow">in</span> <span class="n">single_replay</span><span class="o">.</span><span class="n">events</span> 
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">sc2reader</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">UnitPositionsEvent</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Module-Exports">Module Exports<a class="anchor-link" href="#Module-Exports"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exportable-constants">Exportable constants<a class="anchor-link" href="#Exportable-constants"> </a></h3><p>Additionally, this module exports a constant <a href="/sc_training/handle_tracker_events.html#INTERVALS_BASE"><code>INTERVALS_BASE</code></a> which defines the number of seconds that should determine the time intervals used to analyse the replays.</p>
<p>In the following modules, I separate the analysis of many performance indicators derived from several types of Tracker Events into four game intervals, i.e. the whole, early, mid and late games. These intervals are meant to match the economy and initial strategy building portion of the game (i.e. the early game), the initial strategy execution and response state (i.e. the mid-game), and the counter strategic stage of the game (i.e. the late-game).  The early match takes typically between 4 and 5 minutes, or 240 and 300 seconds. Afterwards, the mid-game takes about the same time. Suppose the game has not ended by minutes 8 to 10. In that case, players typically re-organise their strategy using updated, more advanced and expensive, units, i.e. late game.</p>
<p>Thus, in this case, I establish a base value in seconds that I use in later modules as the finish time for the early game. I also use it to calculate the end mark of the mid-game as double this base value. The late-game always covers the portion from the mid-game's end to the match's end.</p>
<p>I establish this constant here in case I need to change it. This way, any change will automatically be propagated through all modules.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exportable-Functions">Exportable Functions<a class="anchor-link" href="#Exportable-Functions"> </a></h3><p>Similarly, I export the <a href="/sc_training/handle_tracker_events.html#calc_realtime_index"><code>calc_realtime_index</code></a> function. I use this function in later modules to recalculate the time when an event took place in seconds to match the game's recorded length.</p>
<p>This recalculation is necessary because Tracker Events seem to record the time they happened as the quotient of their recorded execution frame and the match's frames-per-second, which does not match its duration,</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calc_realtime_index" class="doc_header"><code>calc_realtime_index</code><a href="https://github.com/HDavidEspinosa/sc_training/tree/master/sc_training/handle_tracker_event.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calc_realtime_index</code>(<strong><code>registered_time</code></strong>:<code>int</code>, <strong><code>rpl</code></strong>:<code>Replay</code>)</p>
</blockquote>
<p>Calculate the time index of an event based on the replay recorded
duration.</p>
<p>Given that the registered time index on TrackerEvents don not necessarily
coincide with the replay duration, this function recalculates the time
index of an event to correct this discrepancy.</p>
<p><em>Args</em></p>

<pre><code>- registered_time (int)
    The time index in seconds recorded in the event. Normally
    accessible through the .second attribute.
- rpl (sc2reader.resources.Replay)
    Working replay

</code></pre>
<p><em>Returns</em></p>

<pre><code>- float
    The time index that would match the replay's duration</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following code illustrates the use of this function to correct the time index of various <code>UnitBornEvent</code>. The function should work just as well with all <code>TrakerEvents</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_e</span> <span class="o">=</span> <span class="n">UnitBorn_e</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span>
<span class="n">second_e</span> <span class="o">=</span> <span class="n">UnitBorn_e</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
<span class="n">last_e</span> <span class="o">=</span> <span class="n">UnitBorn_e</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit: </span><span class="si">{</span><span class="n">first_e</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s1">&gt;8</span><span class="si">}</span><span class="s1">, Birth recorded time: </span><span class="si">{</span><span class="n">first_e</span><span class="o">.</span><span class="n">second</span><span class="si">:</span><span class="s1">&gt;5</span><span class="si">}</span><span class="s1">, Brith real time: </span><span class="si">{</span><span class="n">calc_realtime_index</span><span class="p">(</span><span class="n">first_e</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">single_replay</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;7.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit: </span><span class="si">{</span><span class="n">second_e</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s1">&gt;8</span><span class="si">}</span><span class="s1">, Birth recorded time: </span><span class="si">{</span><span class="n">second_e</span><span class="o">.</span><span class="n">second</span><span class="si">:</span><span class="s1">&gt;5</span><span class="si">}</span><span class="s1">, Brith real time: </span><span class="si">{</span><span class="n">calc_realtime_index</span><span class="p">(</span><span class="n">second_e</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">single_replay</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;7.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit: </span><span class="si">{</span><span class="n">last_e</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s1">&gt;8</span><span class="si">}</span><span class="s1">, Birth recorded time: </span><span class="si">{</span><span class="n">last_e</span><span class="o">.</span><span class="n">second</span><span class="si">:</span><span class="s1">&gt;5</span><span class="si">}</span><span class="s1">, Brith real time: </span><span class="si">{</span><span class="n">calc_realtime_index</span><span class="p">(</span><span class="n">last_e</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">single_replay</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;7.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit: </span><span class="si">{</span><span class="s2">&quot;FinalFrame&quot;</span><span class="si">:</span><span class="s1">&gt;8</span><span class="si">}</span><span class="s1">, Birth recorded time: </span><span class="si">{</span><span class="mi">826</span><span class="si">:</span><span class="s1">&gt;5</span><span class="si">}</span><span class="s1">, Brith real time: </span><span class="si">{</span><span class="n">calc_realtime_index</span><span class="p">(</span><span class="mi">826</span><span class="p">,</span> <span class="n">single_replay</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;7.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Unit:    Probe, Birth recorded time:     0, Brith real time:    0.00
Unit:    Probe, Birth recorded time:    18, Brith real time:   12.86
Unit:    Probe, Birth recorded time:   820, Brith real time:  585.71
Unit: FinalFrame, Birth recorded time:   826, Brith real time:  590.00
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

